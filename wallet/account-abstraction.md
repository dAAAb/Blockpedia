# 帳戶抽象（Account Abstraction）

### 帳戶抽象是以太坊的重要升級，讓你的錢包可以像智能合約一樣可程式化。它解決了傳統錢包的痛點：忘記私鑰就完蛋、每筆交易都要付 ETH、操作複雜難上手。

---

## 為什麼需要帳戶抽象？

目前以太坊有兩種帳戶：

| 類型 | 全名 | 控制方式 | 功能 |
|------|------|----------|------|
| EOA | 外部擁有帳戶 | 私鑰 | 發起交易 |
| CA | 合約帳戶 | 程式碼 | 執行邏輯 |

普通錢包（MetaMask）都是 EOA，它有幾個大問題：

### 問題 1：私鑰就是一切

弄丟私鑰 = 資產永久消失。沒有找回密碼、沒有客服支援。

### 問題 2：必須用 ETH 付 Gas

想轉 USDC？你得先有 ETH 付手續費。這對新手很不友善。

### 問題 3：每筆交易都要手動簽名

批量操作很麻煩，而且容易簽到惡意交易。

### 問題 4：沒有進階功能

不能設定交易限額、不能自動執行、不能多人管理。

---

## 帳戶抽象如何解決？

帳戶抽象的核心概念是：**讓你的帳戶變成智能合約**。

這意味著你的錢包可以有程式邏輯，例如：

- 社交恢復（朋友幫你找回錢包）
- 支出限額（每天最多轉 1000 美元）
- 用任何代幣付 Gas（用 USDC 付手續費）
- 批量交易（一次簽名，多個操作）
- 自動化（定期定額投資）

{% hint style="info" %}
**類比理解**

EOA 就像一把簡單的鑰匙——誰拿到就是誰的。

帳戶抽象就像智慧門鎖——可以設密碼、可以指紋、可以遠端開門、可以設定訪客權限、可以看誰開過門。
{% endhint %}

---

## ERC-4337：以太坊的實現方案

2023 年 3 月，以太坊主網啟用了 **ERC-4337**，這是帳戶抽象的標準實現。

### 運作原理

```
用戶意圖 → UserOperation → Bundler → EntryPoint → 智能合約錢包
```

1. **用戶**：創建「UserOperation」（想做什麼）
2. **Bundler**：收集多個 UserOperation，打包成交易
3. **EntryPoint**：驗證並執行這些操作
4. **智能合約錢包**：你的帳戶，執行實際邏輯

### 關鍵角色

| 角色 | 功能 |
|------|------|
| Bundler | 收集用戶操作，支付 Gas，提交交易 |
| Paymaster | 替用戶支付 Gas（可用其他代幣） |
| EntryPoint | 全局合約，協調一切 |
| 智能合約錢包 | 用戶的帳戶，可自定義邏輯 |

---

## 帳戶抽象能做什麼？

### 1. 社交恢復（Social Recovery）

設定幾個「監護人」（可以是朋友、家人、硬體設備）。如果你弄丟私鑰，監護人可以幫你恢復。

**例子**：設定 3 個監護人，任意 2 個同意就能恢復錢包。

### 2. 無 Gas 交易

**Paymaster** 可以替你支付 Gas 費用。

- 用 USDC 付手續費
- 項目方補貼用戶 Gas
- 訂閱制：月付固定費用，無限交易

### 3. 批量交易

一次簽名，執行多個操作：
- Approve + Swap（本來要簽兩次）
- 批量 NFT 轉移
- 一次性完成複雜的 DeFi 操作

### 4. 交易限制

- 每日支出上限
- 大額轉帳需要額外確認
- 只允許與白名單地址互動

### 5. 自動化

- 定期定額買幣
- 自動止損
- 訂閱付款

### 6. 多簽與權限管理

- 需要多人授權的企業錢包
- 不同金額不同權限
- 緊急暫停功能

---

## 支援帳戶抽象的錢包

| 錢包 | 特點 |
|------|------|
| **Safe（原 Gnosis Safe）** | 最成熟的多簽錢包 |
| **Argent** | 社交恢復、無 Gas |
| **Soul Wallet** | 開源、模組化 |
| **Sequence** | 遊戲導向、無縫體驗 |
| **ZeroDev** | 開發者工具包 |
| **Biconomy** | 提供 SDK 和基礎設施 |

---

## 對普通用戶的意義

### 更友善的入門體驗

- 不需要先買 ETH 才能操作
- 熟悉的登入方式（Email、社交帳號）
- 弄丟密碼可以找回

### 更安全

- 惡意交易可以設限阻擋
- 大額轉帳多重確認
- 不再「一個私鑰控制一切」

### 更像傳統 App

- 批量操作、一次簽名
- 自動化功能
- 更流暢的用戶體驗

{% hint style="success" %}
**長期願景**

帳戶抽象的目標是讓使用區塊鏈就像使用一般 App 一樣簡單。用戶不需要知道什麼是私鑰、Gas、nonce——這些都在背後自動處理。
{% endhint %}

---

## 各鏈的帳戶抽象

| 區塊鏈 | 實現方式 |
|--------|----------|
| 以太坊 | ERC-4337（智能合約層） |
| zkSync | 原生支援 |
| StarkNet | 原生支援 |
| Polygon | ERC-4337 |
| Arbitrum | ERC-4337 |
| Base | ERC-4337 |

有些 L2（如 zkSync、StarkNet）從一開始就設計成原生支援帳戶抽象，不需要額外的協議。

---

## 常見問題

### Q：帳戶抽象會讓我的舊錢包失效嗎？

不會。EOA 仍然可以正常使用。帳戶抽象是新增功能，不是取代。

### Q：智能合約錢包比 EOA 貴嗎？

創建時會貴一點（要部署合約），但長期使用可能更省（批量交易、Gas 優化）。

### Q：夠安全嗎？

智能合約錢包的安全性取決於合約程式碼。選擇經過審計、廣泛使用的錢包（如 Safe）比較安全。

### Q：我應該現在就換成帳戶抽象錢包嗎？

如果你是一般用戶，目前 MetaMask 等 EOA 錢包仍然夠用。但如果你需要多簽、社交恢復等進階功能，可以考慮。

---

## 延伸閱讀

- [電子錢包](README.md) — 錢包基礎知識
- [私鑰](si/) — 了解私鑰的重要性
- [多重簽名](ming/duo-zhong-ming.md) — 帳戶抽象的常見應用
- [智能合約](../smart-contract/) — 帳戶抽象的技術基礎
