---
description: 拜占庭將軍問題是分散式計算的經典難題，描述如何在有叛徒的情況下達成共識。比特幣首次實際解決了這個問題。
---

# 拜占庭將軍問題

### 想像一群將軍圍攻一座城市。他們必須同時進攻才能獲勝，但只能透過信使溝通。問題是：有些將軍可能是叛徒，會發送錯誤的訊息。如何確保忠誠的將軍能達成一致？這就是區塊鏈要解決的核心問題。

---

## 問題描述

| 概念 | 說明 |
|------|------|
| 提出者 | Leslie Lamport 等人（1982）|
| 核心問題 | 不信任環境中如何達成共識？ |
| 應用 | 分散式系統、區塊鏈 |

---

## 經典場景

```
拜占庭將軍問題：

情境：
- 多位將軍圍攻城市
- 必須同時進攻或同時撤退
- 只能透過信使溝通
- 有些將軍可能是叛徒

挑戰：
- 叛徒會發送矛盾的訊息
- 信使可能被攔截
- 如何確保忠誠將軍達成一致？

            將軍 A（忠誠）
           ↙      ↘
     將軍 B         將軍 C
    （叛徒）       （忠誠）

B 對 A 說「進攻」
B 對 C 說「撤退」
→ A 和 C 無法一致
```

---

## 為什麼難解？

### 核心困難

| 困難 | 說明 |
|------|------|
| 無法識別叛徒 | 叛徒不會自己承認 |
| 訊息可被偽造 | 沒有中央認證機構 |
| 非同步通訊 | 不知道訊息是否送達 |

### 數學限制

```
拜占庭容錯的限制：

如果有 f 個叛徒，需要至少 3f+1 個節點

例子：
- 3 個叛徒 → 需要至少 10 個節點
- 要容忍 1/3 的惡意節點

為什麼是 1/3？
- 數學證明的極限
- 超過 1/3 無法保證正確
```

{% hint style="info" %}
**1/3 的魔法數字**

無論演算法多聰明，如果超過 1/3 的節點是惡意的，就無法保證達成正確的共識。這是數學證明的結果，不是技術限制。
{% endhint %}

---

## 傳統解決方案

### PBFT

| 項目 | 說明 |
|------|------|
| 全名 | Practical Byzantine Fault Tolerance |
| 年份 | 1999 |
| 特點 | 需要知道所有節點 |
| 限制 | 節點數量有限 |

```
PBFT 的運作：

1. 選出一個領導者（Primary）
2. 領導者提議一個值
3. 所有節點互相確認
4. 收到 2/3 同意就確定

問題：
- 通訊量是 O(n²)
- 節點多了會很慢
- 需要知道所有節點是誰
```

---

## 比特幣的解決方案

### 中本聰共識

| 創新 | 說明 |
|------|------|
| 工作量證明 | 用算力投票 |
| 最長鏈規則 | 大家追隨最長的鏈 |
| 經濟激勵 | 作惡不划算 |
| 開放參與 | 任何人都可以加入 |

```
比特幣如何解決拜占庭問題？

1. 不需要知道有多少節點
2. 用算力代替投票
3. 經濟激勵確保誠實
4. 機率性最終性

關鍵洞察：
- 攻擊需要花費真金白銀（電力）
- 誠實行為有獎勵
- 攻擊成功也會傷害自己的利益
```

### 代價

| 代價 | 說明 |
|------|------|
| 能源消耗 | 需要大量算力 |
| 速度慢 | 需要等待確認 |
| 機率最終性 | 理論上可以回滾 |

{% hint style="warning" %}
**機率最終性**

比特幣交易不是「100% 確定」，而是「確認越多，越難回滾」。6 個確認後，回滾的機率極低，但理論上不是零。
{% endhint %}

---

## 拜占庭容錯 vs 崩潰容錯

| 比較 | 崩潰容錯 | 拜占庭容錯 |
|------|----------|------------|
| 假設 | 節點只會停止 | 節點會作惡 |
| 容錯 | 1/2 | 1/3 |
| 演算法 | Paxos、Raft | PBFT、PoW |
| 應用 | 資料庫 | 區塊鏈 |

---

## 現代區塊鏈的解決方案

### 各種方法

| 方法 | 說明 | 代表 |
|------|------|------|
| PoW | 算力投票 | Bitcoin |
| PoS | 質押投票 | Ethereum |
| DPoS | 代表投票 | EOS |
| BFT 變體 | 傳統 BFT 改良 | Cosmos |

---

## 延伸閱讀

- [雙花問題](hua.md) — 另一個關鍵挑戰
- [工作量證明](../gong-zuo-liang-ming.md) — PoW 詳解
- [共識機制](../README.md) — 共識總覽

---

#### 參考資料

- [The Byzantine Generals Problem (原始論文)](https://lamport.azurewebsites.net/pubs/byz.pdf)
- [Bitcoin Whitepaper](https://bitcoin.org/bitcoin.pdf)

